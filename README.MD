# Cours - MAC, Hash, Chiffrement Authentifi√©

## Probabilisme / D√©terminisme

- `KeyGen` est **probabiliste** (g√©n√®re une cl√© al√©atoire).
- `Encrypt` est **probabiliste** (utilise souvent un IV ou du padding al√©atoire).
- `Decrypt` est **d√©terministe** (r√©sultat unique si les entr√©es sont valides).

---

## MAC - Int√©grit√© des Donn√©es

- Un **MAC** (Message Authentication Code) assure **l'int√©grit√©** et **l'authenticit√©** d‚Äôun message.

### Mod√®les d'attaquant

- Une **contrefa√ßon** consiste √† produire un couple (M', T') valide, sans conna√Ætre la cl√©.
- Objectif : forger le bon tag T' pour un message M'.

### Types d‚Äôattaques

- **Existentielles** : r√©ussir √† forger un couple valide (M', T') quelconque.
- **Universelles** : attaquant capable de forger n‚Äôimporte quel message/tag valide.

> ‚ö†Ô∏è Si (M, T) est un couple d√©j√† vu, ce n‚Äôest **pas** une contrefa√ßon.

### Sc√©narios d'attaque

- **Messages connus** : l'attaquant a acc√®s √† plusieurs couples (M, T).
- **Messages choisis** : l'attaquant choisit les messages et observe les tags g√©n√©r√©s.

---

## S√©curit√© d‚Äôun MAC

- **Brute force sur la cl√©** : essayer toutes les cl√©s possibles.
- **Brute force sur le tag** : tester toutes les valeurs de tag possibles.

üîê Le tag doit √™tre suffisamment long : typiquement **2‚Åπ‚Å∂** bits.

> Pourquoi pas plus long ?  
> Pour limiter les temps de r√©ponse en ligne et √©viter les risques de **bannissement** ou **d√©tection d‚Äôattaque**.

---

## Propri√©t√©s de l‚Äôop√©rateur XOR

- A ‚äï B = B ‚äï A (commutatif)
- Exemple :
  - m1, m2, m3 et T
  - m1‚Ä≤, m2‚Ä≤, m3‚Ä≤ et T‚Ä≤

---

## Structure d‚Äôun MAC

- Un **tag** est le **r√©sultat d‚Äôun calcul** utilisant une cl√© secr√®te.
- Exemples de MAC robustes :
  - **AES-128-EMAC**
  - **AES-256-CBC-MAC**

### CBC-MAC

- Pas d‚ÄôIV
- Taille de bloc fixe
- Utilis√© dans IPSec, GlobalPlatform, etc.
- Robuste, mais attention : n√©cessite des messages de **taille fixe** ou des m√©canismes d'encapsulation.

### EMAC

- Ajoute une **couche de chiffrement** suppl√©mentaire
- D√©pend de la taille de bloc, de la cl√©

---

## HMAC et Fonctions de Hachage

### S√©curit√© d‚Äôun hash

- **Pr√©image** : difficile de trouver un message M tel que H(M) = T
- **R√©sistance aux collisions** : difficile de trouver deux messages M ‚â† M‚Ä≤ tels que H(M) = H(M‚Ä≤)
- Espace requis : ‚âà (2^h / 2) * h bits (attaque de type "birthday")

### Fonction de hachage seule

- **Ne garantit pas l'int√©grit√©** : sans cl√©, on peut forger => **attaque universelle**

### Fonction √©ponge (Sponge Function)

- Utilis√©e dans SHA-3
- Param√®tres :
  - r : taux (rate)
  - c : capacit√© (capacity)
- Plus la capacit√© est grande, plus la s√©curit√© est √©lev√©e
- MAC via √©ponge : injecter la **cl√© dans la capacit√©**

---

## Fonction de Hachage

- Domaine : {0,1}* ‚Üí {0,1}‚Åø (de taille variable √† taille fixe)
- Pas **sym√©trique** ni **asym√©trique** dans le sens classique : ce sont des **fonctions unidirectionnelles**

---

## Modes de Chiffrement

- **ECB** (Electronic Codebook)
- **CBC** (Cipher Block Chaining)

---

## Chiffrement Authentifi√©

### Trois constructions classiques

1. **Encrypt and MAC**
   - C = Encrypt(K1, M)
   - T = MAC(K2, M)

2. **MAC then Encrypt**
   - T = MAC(K1, M)
   - C = Encrypt(K1, M || T)

3. **Encrypt then MAC** ‚úÖ Recommand√©
   - C = Encrypt(K1, M)
   - T = MAC(K2, C)

Exemple : AES-128-CBC + HMAC-SHA2-256

---

## Construction de Fonction de Hachage

- Probl√®me : **pseudo-collisions**
- Fonction f interne doit √™tre r√©sistante aux collisions

Exemple : (m1, m2, m3), (m1‚Ä≤, m2, m3) ‚áí m√™me H‚Äô : vuln√©rabilit√©
